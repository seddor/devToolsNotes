# [Command-line interface / Commands](https://getcomposer.org/doc/03-cli.md)

`composer list` или `composer` выведет список доступных команд, у каждой можно вызвать `--help`.

## install / i

Установка пакетов описаных в `composer.lock/composer.josn`.

Опции:

* `--prefer-source/--prefer-dist` — есть два способа загрузки пакетов: `source` и `dist`. Для стальных версий composer использует `dist` по умолчанию, `source` используется для репозиториев с системой контроля версий. Соотвено опция `--prefer-<type>` будет загружать пакет предпочитаемым способом, если он доступен для пакета.
* `--dry-run` — зпаускает процес установки без фактической установки пакетов, может пригодится для симуляции установки и запуску каких-нибудь тригеров завязанных на ней.
* `--dev` — так-же утаналвивает пакеты указанные в `require-dev` (дефолтное поведение).
* `--no-dev` — пропускает пакеты из `require-dev`, автолоадинг генерируется игнорируют `autoload-dev`.
* `--no-autoloader` — пропустить генерацию аволоада.
* `--no-scripts` — пропустить скрипты, запускаемые в процесе установки
* `--no-progress` — не показывать процесс установки
* `--optimize-autoloader` — ковертировать PSR-0/4 автолоадинг в класс-мап для оптимизации автозагрузки, рекомендуется только для продакшена, в данный момент не используется по умолчанию.
* `--classmap-authoritative` — автолоадинг только из класс-мапов, включается автоматически при `--optimize-autoloader`.
* `--ignore-platform-reqs` — игноировать проверку для пакетов платформы.

## update / u

Обновление пакетов/пакета до последний доступной версии из `composer.json`. 

Обновление всего
```bash
composr update
```
Обновлени списка пакетов:
```bash
composr update <package_name_1> <package_name_2>
```

поддерживает опции из `install`, а также некторые специфичные:

* `--lock` — обновление только хеша `lock` файла.
* `--prefer-stable` — предпочтать стабильные верси пакетов
* `--prefer-lowest` — предпочитать наименьшие версии пакетов
* `--interactive` — интерактивный интерфейс в ктором можно указать выбирать пакеты для обновленя

## require 

Добавляет новый пакет в `composer.json`

запускает интерактивный интефейс для поиска пакетов
```bash
composer require
```

можно указать конкретный пакет:
```bash
composer require <package_name>:<version>
```

Опции:
* `--dev` — добавляет пакет в `require-dev`
* `--prefer-source`
* `--prefer-dist`
* `--no-progress`
--no-suggest: Skips suggested packages in the output.
* `--no-update` — отключить автоматическе обновление для пакета
* `--no-scripts`
* `-update-no-dev` — запустить обновление зависимостей с `--no-dev`
* `--update-with-dependencies` — обновиь зависмисоти для пакета
* `--update-with-all-dependencies` — обновить так-же зависимости, в том числе корневые
* `--ignore-platform-reqs`
* `--prefer-stable`
* `--prefer-lowest`
* `--sort-packages` 
* `--optimize-autoloader`
* `--classmap-authoritative`

## remove

удлает пакет:
```bash
composer remove <package_name>
```

опции:

* `--dev` — удаляет из `require-dev`
* `--no-progress`
* `--no-update`
* `--no-scripts`
* `--update-no-dev`
* `--update-with-dependencies`
* `--ignore-platform-reqs`
* `--optimize-autoloader`
* `--classmap-authoritative`

## check-platform-reqs

Провеяет зависимости для платформеных пакетов.

## global

Позвоялется запускать команды `install`, `update`, `require`, `update` глобально, т.к. из [`COMPOSER_HOME`](https://getcomposer.org/doc/03-cli.md#composer-home) директории.

используется для всяких пакетов, которые ставятся глобально, например код сниферы для проверки код стандартов.

## search 

команда для поиска пакетов

опции:
* `--only-name (-N)` — искать только названия
* `--type (-t)` — искать пакеты определённых типов

## show

Показывает список пакетов для проекта (на основе conposer.json).

Вывод можно фильтровать по маске:
```bash
composer show monolog/*
```

Если указть полное имя пакета, о нём будет показана подобная информация.

Опции:
* `--all` — список всех пакетов проекта
* `--installed (-i)` — список установленных
* `--platform (-p)` — список платформеных паетов
* `--available (-a)` — список доступных пакетов
* `--self (-s)` — информация о корневом пакете(текущем проекте)
* `--name-only (-N)` — показать только имена
* `--path (-P)` — пути пакетов
* `--tree (-t)` — список зависимостей в виде дерева
* `--latest (-l)` — список пакетов, включая их последние версии
* `--outdated (-o)` — показать пакеты имеющие боллее новые версии.
* `--minor-only (-m)` — показать пакеты у которых есть минорные обновления.
* `--direct (-D)` — список пакетов находящихся в прямой завсимости(в `require`)

## outdated

outdated показывает список установленых пакетов, для которых есть обновления, это алиса к `composer show -lo`

## browse/home

Открыть страницу пакета на package в браузере.

## depends (why)

Показывает зависимости для пакета проекта, опция `--tree (-t)` покажет завсимости в виде дерева.

* `--recursive (-r)` — рекурсивно до корневого пакета.
* `--tree (-t)` — возвращает результаты в виде дерева, подразумевает `-r`.


## prohibits (why-not)

Показывает какие зависимости блокируют установку пакета:

```bash
composer prohibits <package-name> <version>
```

* `--recursive (-r)` — рекурсивно до корневого пакета.
* `--tree (-t)` — возвращает результаты в виде дерева, подразумевает `-r`.

## validate

Валидирует `composer.json`.

* `--no-check-all` — не выводить предпреждения если используются несвязанные ограничения версий.
* `--no-check-lock` — не выводить предупреждения если `composer.lock` устарел.
* `--no-check-publish` — не выводить предупреждение, если `composer.json` не подходит для публикации на Packagist, но в остальном валиден.
* `--with-dependencies` — также провалидировать `composer.josn` у зависимостей.
* `--strict`

## status

проверяет есть ли локальные изменения в пакетах

# self-update (selfupdate)

Обновляет composer до последней версии.

Можно указать конкретную версию:
```bash
composer self-update <verison>
```
* `--rollback (-r)` — откат до предыдущей версии.
* `--clean-backups` — удалить резервные копии. При этом невозможно будет откатиться до прошлой версии!
* `--no-progress` — не показывать результат
* `--update-keys` — запрашивать у пользователя обновление ключа
* `--stable` — только стабильные версии.
* `--preview` — только превью версии
* `--snapshot` — только снепшоты.

## config

Редактирует настройки composer, локально или глобально.

* `--global (-g)` — глобальные настройки.
* `--editor (-e)` — открывает файл `composer.josn` в редакторе, редактор берётся из переменной окружения EDITOR. 
* `--auth (-a)` — изменить данные для авторизации (только для --editor).
* `--unset` — удаляет элемент конфигурации с именем setting-key.
* `--list (-l)` — показывает список текущих параметров конфига.
* `--file="..." (-f)` — изменять указаный файл, вместо `composer.json`. Нельзя использовать в сочетании с опцией --global.
* `--absolute`: возвращает абсолютные пути при получении значений конфигурации `*-dir` вместо относительных.

### Пример 

Изменения репозиториев:
```bash
composer config repositories.foo vcs https://github.com/foo/bar
```
или
```bash
composer config repositories.foo '{"type": "vcs", "url": "http://svn.example.org/my-project/", "trunk-path": "master"}'
```
Дополнительные значений:
```bash
composer config extra.foo.bar value
```

## create-project

можно использовать composer для создания новых проктов на основе существующих пакетов, по сути эта команда аналогичная `git clone && composer install`.
```bash
composer create-project doctrine/orm path 2.2.*
```

* `--stability (-s)` — Минимальная стабильность пакета. По умолчанию - stable.
* `--prefer-source` — устанавливать пакеты из source, когда они доступны.
* `--prefer-dist` — устанавливать пакеты из dist, когда они доступны.
* `--repository` — предоставить пользовательский репозиторий для поиска пакета, который будет использоваться вместо packagist. Может представлять собой либо URL-адрес HTTP, указывающий на репозиторий composer, либо путь к локальному файлу packages.json, либо строку JSON, которая аналогична тому, что принимает ключ репозиториев.
* `--dev` — Установить пакеты, указанные в require-dev.
* `--no-dev` — Отключает установку пакетов require-dev.
* `--no-scripts` — Отключает выполнение сценариев, определенных в корневом пакете.
* `--no-progress` — Удаляет отображение прогресса, которое может запутаться в некоторых терминалах или сценариях, которые не обрабатывают обратные символы.
* `--keep-vcs` — Пропустить удаление метаданных VCS для созданного проекта. Это особенно полезно, если вы запускаете команду в неинтерактивном режиме.
* `--no-install` — Отключает установку поставщиков.
* `--ignore-platform-reqs` — пропустить проверку пакетов платформы.

## dump-autoload (dumpautoload)

обновляет автолоад.

* `--no-scripts` — пропускает выполнение всех сценариев, определенных в файле `composer.json`.
* `--optimize (-o)` — преобразовать автолоадинг PSR-0/4 в classmap.
* `--classmap-authoritative (-a)` — автолоадинг только из класс-мапов, включается автоматически при `--optimize-autoloader`.
* `--apcu` — использовать APCu для кэширования найденных / не найденных классов.
* `--no-dev` — отключает автолоадинг для раздела `dev`.

## clear-cache (clearcache)

Очищает директорию с кешем composer.

## licenses

Показывает имена, версии и лицензии для пакетов.

* `--format` — формат вывода: `text` или `json` (по умолчанию: `text`).
* `--no-dev` — не показывает для зависимостей из `dev`.

## run-script

Используется для запуска [скриптов](https://getcomposer.org/doc/articles/scripts.md) вручную.

* `--timeout` — изменяет таймаут для скрипта, 0 — таймаут отсутвует.
* `--dev` — устанавливает режим `dev`.
* `--no-dev` — отключает режим `dev`.
* `--list (-l)` — показывает список определённых скриптов.

## diagnose

Проверяет распостранённые проблемы.

## archive

Создаёт архив для пакета или проекта, без зависимостей.
```bash
composer archive vendor/package 2.0.21 --format=zip
```

* `--format (-f)` — формат результирующего архива: `tar` или `zip` (по умолчанию: `tar`).
* `--dir` — записать архив в этот каталог (по умолчанию: `.`).
* `--file` — записать архив с заданным именем файла.

## help

Показывает help для команды.
```bash
composer help <comand>
```

### Переменные окружения

* COMPOSER_ALLOW_SUPERUSER — если значения 1, то отключает предупреждения при запуске от рута, так-же отключает автоматическую очистку sudo сессии, можно использовать это если нужно запускать composer всё время от рута,  например в докер контейнере.
* COMPOSER_ALLOW_XDEBUG — позволяет запускать composer с включеным xdebug.
* COMPOSER_AUTH — позволяет установить аутентификацию в качестве переменной окружения, в качестве значения передаётся json, [подробнее](https://getcomposer.org/doc/06-config.md#gitlab-oauth)
* COMPOSER_DISABLE_XDEBUG_WARN — отключает предупреждени при использовании Xdebug
